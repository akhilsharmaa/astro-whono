---
import { formatDateTime } from '../utils/format';

const {
  bit,
  Content,
  author = 'Whono'
} = Astro.props;

const tagsText = (bit.data.tags ?? []).map((t) => `#${t}`).join(' ');

// Used by the client-side search in /bits/
const searchable = [
  bit.data.title ?? '',
  bit.data.description ?? '',
  bit.body ?? '',
  tagsText,
].join(' ').toLowerCase();
---

<article class="bit-card" data-bit data-search={searchable}>
  <div class="bit-author">
    <div class="avatar" aria-hidden="true">{author[0] ?? 'W'}</div>
    <div class="name">{author}</div>
  </div>

  <div class="bit-body">
    <Content />
  </div>

  {bit.data.image ? (
    <div class="bit-media">
      <img src={bit.data.image} alt="" loading="lazy" />
    </div>
  ) : null}

  <div class="bit-meta">
    <div class="bit-tags">{tagsText ? <>‚ù§ {tagsText}</> : null}</div>
    <div>{formatDateTime(bit.data.date)}</div>
  </div>
</article>
